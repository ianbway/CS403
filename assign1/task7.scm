; Ian Braudaway
; CS403 Assign 1, Task 7

(define (double value)
	(+ value value)
	)

(define (div2Helper value counter)
		(cond
			((== value 1) #f)
			((== value 0) #t)
			((> (double counter) value)
				(div2Helper (- value counter) 1))
			(else 
				(div2Helper value (double counter)))
			)
		)

(define (div2? value)
	(div2Helper value 1)
	)

(define (halve-iter value counter store ogVal)
	(cond
		((== value 1) store)
		((== (double store) ogVal)
		 store)
		((> (double (double counter)) value)
			(halve-iter (- value (double counter)) 1 (+ store counter) ogVal))
		(else 
			(halve-iter value (double counter) store ogVal))
		)
	)

(define (halve value)
	(halve-iter value 1 0 value)
	)

(define (ethiop-iter a b c)
	(cond 
		((== a 0) c)
        ((div2? a) (ethiop-iter (halve a) (double b) c))
        (else (ethiop-iter (halve a) (double b) (+ c b)))
        )
	)

(define (ethiop a b)
	(ethiop-iter a b 0)
	)

(define (main)
	(setPort (open (getElement ScamArgs 1) 'read))
	(define a (readExpr))
	(define b (readExpr))
	(println "(halve " a ") is " (halve a))
	(println "(double " a ") is " (double a))
	(println "(div2? " a ") is " (div2? a))
	(println "(ethiop " a " " b ") is " (ethiop a b))
	)

;(inspect (halve 1960))
;(inspect (double 1960))
;(inspect (div2? 1960))
;(inspect (ethiop 1960 56))
;(inspect (halve 21))
;(inspect (double 21))
;(inspect (div2? 21))
;(inspect (ethiop 21 131))
;(inspect (halve 36))
;(inspect (double 36))
;(inspect (div2? 36))
;(inspect (ethiop 36 103))
;(inspect (halve 161))
;(inspect (double 161))
;(inspect (div2? 161))
;(inspect (ethiop 161 52))
;(inspect (halve 13955))
;(inspect (double 13955))
;(inspect (div2? 13955))
;(inspect (ethiop 13955 18955))
;(inspect (halve 14774))
;(inspect (double 14774))
;(inspect (div2? 14774))
;(inspect (ethiop 14774 10265))
;(inspect (halve 10624))
;(inspect (double 10624))
;(inspect (div2? 10624))
;(inspect (ethiop 10624 11573))
;(inspect (halve 16423))
;(inspect (double 16423))
;(inspect (div2? 16423))
;(inspect (ethiop 16423 12836))
;(inspect (halve 12321))
;(inspect (double 12321))
;(inspect (div2? 12321))
;(inspect (ethiop 12321 14204))
;(inspect (halve 13138))
;(inspect (double 13138))
;(inspect (div2? 13138))
;(inspect (ethiop 13138 15498))
;(inspect (halve 19015))
;(inspect (double 19015))
;(inspect (div2? 19015))
;(inspect (ethiop 19015 11841))
