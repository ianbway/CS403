; Ian Braudaway
; CS403 Assign 2, Task 8

(define (insertBST tree value)
	(define (iter root)
		(cond
			((> value (root'value))
				(cond
					((nil? (root'right))
						(node (root'value) (root'left) (node value nil nil)))
					(else
						(node (root'value) (root'left) (iter (root'right))))
					)
				)
			(else
				(cond
					((nil? (root'left))
						(node (root'value) (node value nil nil) (root'right)))
					(else
						(node (root'value) (iter (root'left)) (root'right)))
					)
				)
			)
		)
	(iter tree)
	)

(define (node value left right)
	(define (display) (print value))
	this
	)

(define (newBST value)
	(node value nil nil)
	)

(define (displayBST root)
	(define (iter root indent)
		(if (valid? root)
			(begin
				(iter (root'right) (string+ indent "    "))
				(print indent)
				((root'display))
				(println)
				(iter (root'left) (string+ indent "    "))
				)
			)
		)
	(iter root "")
	)

(define (main)
	(setPort (open (getElement ScamArgs 1) 'read))
	(define env this)
	(define (iter expr)
		(if (not (eof?)) (begin (eval expr env) (iter (readExpr)))))
	(iter (readExpr))
	)

; (define t0 (newBST 5))
; (define t1 (insertBST t0 2))
; (define t2 (insertBST t1 8))
; (displayBST t2)

; (define t0 (newBST 5))
; (displayBST t0)

; (define t1 (newBST 77))
; (define t2 (insertBST t1 50))
; (define t3 (insertBST t2 61))
; (define t4 (insertBST t3 49))
; (define t5 (insertBST t4 25))
; (define t6 (insertBST t5 76))
; (define t7 (insertBST t6 20))
; (define t8 (insertBST t7 62))
; (define t9 (insertBST t8 44))
; (define t10 (insertBST t9 27))
; (define t11 (insertBST t10 46))
; (define t12 (insertBST t11 95))
; (define t13 (insertBST t12 87))
; (define t14 (insertBST t13 26))
; (define t15 (insertBST t14 16))
; (define t16 (insertBST t15 15))
; (define t17 (insertBST t16 81))
; (displayBST t17)

; (define t1 (newBST 39))
; (define t2 (insertBST t1 40))
; (define t3 (insertBST t2 70))
; (define t4 (insertBST t3 88))
; (define t5 (insertBST t4 73))
; (define t6 (insertBST t5 77))
; (define t7 (insertBST t6 99))
; (define t8 (insertBST t7 32))
; (define t9 (insertBST t8 66))
; (define t10 (insertBST t9 72))
; (define t11 (insertBST t10 97))
; (define t12 (insertBST t11 57))
; (define t13 (insertBST t12 90))
; (define t14 (insertBST t13 96))
; (define t15 (insertBST t14 45))
; (define t16 (insertBST t15 46))
; (define t17 (insertBST t16 78))
; (define t18 (insertBST t17 83))
; (displayBST t18)

; (define t1 (newBST 47))
; (define t2 (insertBST t1 22))
; (define t3 (insertBST t2 71))
; (define t4 (insertBST t3 93))
; (define t5 (insertBST t4 92))
; (define t6 (insertBST t5 37))
; (define t7 (insertBST t6 43))
; (define t8 (insertBST t7 48))
; (define t9 (insertBST t8 35))
; (define t10 (insertBST t9 68))
; (define t11 (insertBST t10 39))
; (define t12 (insertBST t11 61))
; (define t13 (insertBST t12 90))
; (define t14 (insertBST t13 57))
; (define t15 (insertBST t14 87))
; (define t16 (insertBST t15 62))
; (define t17 (insertBST t16 19))
; (define t18 (insertBST t17 33))
; (define t19 (insertBST t18 97))
; (define t20 (insertBST t19 86))
; (displayBST t20)

; (define t1 (newBST 99))
; (define t2 (insertBST t1 49))
; (define t3 (insertBST t2 69))
; (define t4 (insertBST t3 75))
; (define t5 (insertBST t4 61))
; (define t6 (insertBST t5 81))
; (define t7 (insertBST t6 71))
; (define t8 (insertBST t7 37))
; (define t9 (insertBST t8 63))
; (define t10 (insertBST t9 24))
; (define t11 (insertBST t10 88))
; (displayBST t11)

; (define t1 (newBST 17))
; (define t2 (insertBST t1 61))
; (define t3 (insertBST t2 25))
; (define t4 (insertBST t3 60))
; (define t5 (insertBST t4 78))
; (define t6 (insertBST t5 22))
; (define t7 (insertBST t6 77))
; (define t8 (insertBST t7 37))
; (define t9 (insertBST t8 57))
; (define t10 (insertBST t9 49))
; (define t11 (insertBST t10 88))
; (define t12 (insertBST t11 46))
; (displayBST t12)

; (define t1 (newBST 25))
; (define t2 (insertBST t1 32))
; (define t3 (insertBST t2 47))
; (define t4 (insertBST t3 86))
; (define t5 (insertBST t4 22))
; (define t6 (insertBST t5 69))
; (define t7 (insertBST t6 54))
; (define t8 (insertBST t7 42))
; (define t9 (insertBST t8 13))
; (define t10 (insertBST t9 43))
; (define t11 (insertBST t10 46))
; (define t12 (insertBST t11 76))
; (define t13 (insertBST t12 29))
; (define t14 (insertBST t13 96))
; (define t15 (insertBST t14 34))
; (define t16 (insertBST t15 17))
; (define t17 (insertBST t16 49))
; (define t18 (insertBST t17 12))
; (define t19 (insertBST t18 19))
; (define t20 (insertBST t19 36))
; (define t21 (insertBST t20 50))
; (define t22 (insertBST t21 66))
; (define t23 (insertBST t22 67))
; (define t24 (insertBST t23 73))
; (define t25 (insertBST t24 51))
; (define t26 (insertBST t25 62))
; (define t27 (insertBST t26 15))
; (define t28 (insertBST t27 89))
; (define t29 (insertBST t28 63))
; (define t30 (insertBST t29 74))
; (define t31 (insertBST t30 75))
; (define t32 (insertBST t31 80))
; (define t33 (insertBST t32 55))
; (define t34 (insertBST t33 56))
; (define t35 (insertBST t34 88))
; (define t36 (insertBST t35 33))
; (define t37 (insertBST t36 37))
; (define t38 (insertBST t37 83))
; (define t39 (insertBST t38 68))
; (define t40 (insertBST t39 99))
; (define t41 (insertBST t40 57))
; (define t42 (insertBST t41 84))
; (define t43 (insertBST t42 11))
; (define t44 (insertBST t43 14))
; (define t45 (insertBST t44 78))
; (define t46 (insertBST t45 21))
; (define t47 (insertBST t46 82))
; (define t48 (insertBST t47 58))
; (define t49 (insertBST t48 70))
; (define t50 (insertBST t49 26))
; (define t51 (insertBST t50 40))
; (define t52 (insertBST t51 27))
; (define t53 (insertBST t52 87))
; (define t54 (insertBST t53 72))
; (define t55 (insertBST t54 28))
; (define t56 (insertBST t55 92))
; (define t57 (insertBST t56 31))
; (define t58 (insertBST t57 35))
; (define t59 (insertBST t58 61))
; (define t60 (insertBST t59 93))
; (displayBST t60)

; (define t1 (newBST 32))
; (define t2 (insertBST t1 84))
; (define t3 (insertBST t2 70))
; (define t4 (insertBST t3 72))
; (define t5 (insertBST t4 80))
; (define t6 (insertBST t5 79))
; (define t7 (insertBST t6 20))
; (define t8 (insertBST t7 42))
; (define t9 (insertBST t8 59))
; (define t10 (insertBST t9 19))
; (define t11 (insertBST t10 38))
; (define t12 (insertBST t11 46))
; (define t13 (insertBST t12 14))
; (define t14 (insertBST t13 98))
; (define t15 (insertBST t14 22))
; (define t16 (insertBST t15 18))
; (define t17 (insertBST t16 53))
; (define t18 (insertBST t17 75))
; (define t19 (insertBST t18 83))
; (define t20 (insertBST t19 36))
; (define t21 (insertBST t20 23))
; (define t22 (insertBST t21 30))
; (define t23 (insertBST t22 17))
; (define t24 (insertBST t23 92))
; (define t25 (insertBST t24 93))
; (define t26 (insertBST t25 60))
; (define t27 (insertBST t26 90))
; (define t28 (insertBST t27 66))
; (define t29 (insertBST t28 89))
; (define t30 (insertBST t29 64))
; (define t31 (insertBST t30 82))
; (define t32 (insertBST t31 55))
; (define t33 (insertBST t32 43))
; (define t34 (insertBST t33 69))
; (define t35 (insertBST t34 39))
; (define t36 (insertBST t35 62))
; (define t37 (insertBST t36 15))
; (define t38 (insertBST t37 40))
; (define t39 (insertBST t38 13))
; (define t40 (insertBST t39 91))
; (define t41 (insertBST t40 96))
; (define t42 (insertBST t41 56))
; (define t43 (insertBST t42 12))
; (define t44 (insertBST t43 76))
; (define t45 (insertBST t44 29))
; (define t46 (insertBST t45 33))
; (define t47 (insertBST t46 37))
; (define t48 (insertBST t47 16))
; (define t49 (insertBST t48 58))
; (define t50 (insertBST t49 48))
; (define t51 (insertBST t50 77))
; (define t52 (insertBST t51 61))
; (define t53 (insertBST t52 85))
; (define t54 (insertBST t53 27))
; (define t55 (insertBST t54 81))
; (define t56 (insertBST t55 50))
; (define t57 (insertBST t56 34))
; (define t58 (insertBST t57 31))
; (define t59 (insertBST t58 68))
; (define t60 (insertBST t59 11))
; (define t61 (insertBST t60 49))
; (define t62 (insertBST t61 65))
; (define t63 (insertBST t62 78))
; (define t64 (insertBST t63 95))
; (displayBST t64)

; (define t1 (newBST 85))
; (define t2 (insertBST t1 36))
; (define t3 (insertBST t2 51))
; (define t4 (insertBST t3 72))
; (define t5 (insertBST t4 57))
; (define t6 (insertBST t5 55))
; (define t7 (insertBST t6 24))
; (define t8 (insertBST t7 31))
; (define t9 (insertBST t8 25))
; (define t10 (insertBST t9 49))
; (define t11 (insertBST t10 39))
; (define t12 (insertBST t11 54))
; (define t13 (insertBST t12 79))
; (define t14 (insertBST t13 43))
; (define t15 (insertBST t14 35))
; (define t16 (insertBST t15 95))
; (define t17 (insertBST t16 37))
; (define t18 (insertBST t17 74))
; (define t19 (insertBST t18 12))
; (define t20 (insertBST t19 86))
; (define t21 (insertBST t20 61))
; (define t22 (insertBST t21 40))
; (define t23 (insertBST t22 56))
; (define t24 (insertBST t23 59))
; (define t25 (insertBST t24 77))
; (define t26 (insertBST t25 27))
; (define t27 (insertBST t26 78))
; (define t28 (insertBST t27 19))
; (define t29 (insertBST t28 76))
; (define t30 (insertBST t29 66))
; (define t31 (insertBST t30 70))
; (define t32 (insertBST t31 96))
; (define t33 (insertBST t32 28))
; (define t34 (insertBST t33 83))
; (define t35 (insertBST t34 30))
; (define t36 (insertBST t35 60))
; (define t37 (insertBST t36 71))
; (define t38 (insertBST t37 90))
; (define t39 (insertBST t38 16))
; (define t40 (insertBST t39 41))
; (define t41 (insertBST t40 99))
; (define t42 (insertBST t41 87))
; (define t43 (insertBST t42 73))
; (define t44 (insertBST t43 47))
; (define t45 (insertBST t44 58))
; (define t46 (insertBST t45 65))
; (define t47 (insertBST t46 81))
; (define t48 (insertBST t47 64))
; (define t49 (insertBST t48 21))
; (define t50 (insertBST t49 68))
; (define t51 (insertBST t50 50))
; (define t52 (insertBST t51 97))
; (define t53 (insertBST t52 53))
; (displayBST t53)
